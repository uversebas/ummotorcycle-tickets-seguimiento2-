<div class="col-lg-12 mb-5">
  <div class="card">
    <div class="card-header">
      <h3 class="h6 text-uppercase mb-0">Approve and Review</h3>
    </div>
    <div class="card-body">
      <form [formGroup]="formularioRevisionAprobacion">
        <div class="form-group row">
          <div class="col-lg-6">
            <label for="categoria" class="form-control-label text-uppercase">Failure Category</label>
            <select id="categoria" name="categoria" formControlName="categoria" class="form-control"
              [(ngModel)]="categoriaSeleccionada" [ngClass]="{ 'is-invalid': submitted && f.categoria.errors }">
              <option hidden value="null" disabled selected>
                Select failure category
              </option>
              <option [ngValue]="categoria" *ngFor="let categoria of categoriasFallas">
                {{ categoria.nombre }}
              </option>
            </select>
            <div *ngIf="submitted && f.categoria.errors" class="invalid-feedback">
              <div *ngIf="f.categoria.errors.required">
                This field is required
              </div>
            </div>
          </div>
          <div class="col-lg-6">
            <label for="fabrica" class="form-control-label text-uppercase">Factory</label>
            <select id="fabrica" name="fabrica" formControlName="fabrica" class="form-control"
              [(ngModel)]="fabricaSeleccionada" [ngClass]="{ 'is-invalid': submitted && f.fabrica.errors }">
              <option hidden value="null" disabled selected>
                Select factory
              </option>
              <option [ngValue]="fabrica" *ngFor="let fabrica of fabricas">
                {{ fabrica.nombre }}
              </option>
            </select>
            <div *ngIf="submitted && f.fabrica.errors" class="invalid-feedback">
              <div *ngIf="f.fabrica.errors.required">
                This field is required
              </div>
            </div>
          </div>
        </div>
        <div class="form-group row" *ngIf="habilitado">
          <div class="col-lg-12">
            <label for="comentario" class="form-control-label text-uppercase">Comment</label>
            <textarea autosize name="comentario" id="comentario" formControlName="comentario" class="form-control"
              rows="3" placeholder="Please write a comment ..." style="resize: none"
              [ngClass]="{ 'is-invalid': submitted && f.comentario.errors}"></textarea>
            <div *ngIf="submitted && f.comentario.errors" class="invalid-feedback">
              <div *ngIf="f.comentario.errors.required">
                This field is required
              </div>
            </div>
          </div>
        </div>
        <div class="form-group row" *ngIf="habilitado">
          <div class="col-lg-12">
            <label for="adjuntoCliente" class="form-control-label text-uppercase">Client document</label><br />
            <input type="file" id="adjuntoCliente" name="adjuntoCliente" formControlName="adjuntoCliente"
              (change)="subirAdjuntoCliente($event)">
          </div>
        </div>
        <div class="form-group row">
          <fieldset class="col-lg-6" *ngIf="comentarios.length > 0">
            <legend>Comments</legend>
            <div class="comment-widgets m-b-20">
              <div class="d-flex flex-row comment-row" *ngFor="let comentario of comentarios">
                <div class="p-2"><span class="round"><img src="/assets/images/user-comment.png" alt="user"
                      width="50"></span></div>
                <div class="comment-text w-100">
                  <h5>{{comentario?.autor}}</h5>
                  <div class="comment-footer"> <span class="date">{{ comentario?.fechaCreacion |
                      date:'medium' }}</span>
                  </div>
                  <p class="m-b-5 m-t-10">{{comentario?.valor}}</p>
                </div>
              </div>
            </div>
          </fieldset>
          <fieldset class="col-lg-6" *ngIf="ticket.documentosCliente.length > 0">
            <legend>Client documents</legend>
            <div class="row">
              <div class="col-lg-3">
                <ul class="list-inline">
                  <li *ngFor="let documento of ticket.documentosCliente; index as i" class="list-inline-item">
                    <a href="{{documento.url}}" download tooltip="Client document {{i+1}}">
                      <img src="/assets/images/document.png" alt="document">
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </fieldset>
        </div>
        <div class="line"></div>
        <div class="row" *ngIf="habilitado">
          <div class="col-lg-12 zona-botones">
            <button type="button" class="btn btn-secondary cancelar botonera" (click)="onSubmit('sendClient')">
              Send Client
            </button>
            <button type="button" class="btn btn-success um-success botonera" (click)="onSubmit('sendSupport')">
              Send Support
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<ngx-spinner bdColor="rgba(51,51,51,0.8)" size="medium" color="#fff" type="ball-scale-multiple">
  <p style="font-size: 20px; color: white">Processing...</p>
</ngx-spinner>